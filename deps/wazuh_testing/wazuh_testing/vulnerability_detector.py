# Copyright (C) 2015-2020, Wazuh Inc.
# Created by Wazuh, Inc. <info@wazuh.com>.
# This program is free software; you can redistribute it and/or modify it under the terms of GPLv2

from wazuh_testing.tools.monitoring import FileMonitor

def callback_detect_init(line):
    print('Read log line: ' + line)
    if "Created new thread for the 'vulnerability-detector' module" in line:
        return line
    return None


def callback_detect_alert(line):
    print('Read log line: ' + line)
    if "" in line:
      return line
    return None


def detect_init(file_monitor):
    """
    Detect init of thread when restarting Wazuh.

    Parameters
    ----------
    file_monitor : FileMonitor
        File log monitor to detect events
    """
    file_monitor.start(timeout=60, callback=callback_detect_init,
                        error_message='Error vuln init line not detected')

def detect_alert(file_monitor):
    file_monitor.start(timeout=60, callback=callback_detect_alert,
                        error_message='Error vuln alert not detected')